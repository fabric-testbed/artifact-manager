{% extends 'base.html' %}
{% load static artifact_tags django_bootstrap5 %}
{% block title %}
    FABRIC Artifact Manager
{% endblock %}

{% block content %}
    {% if message %}
        <div class="text-danger" style="font-size: large">{{ message }}</div>
    {% endif %}
    <div class="container w-85">
        <table class="table table-striped table-bordered my-4">
            <tbody>
            <tr>
                <td>
                    <div class="inline">
                        <h2>{{ artifact.title }}</h2>
                    </div>
                    <section class="artifactBody__description">
                        {{ artifact.description_long|safe }}
                    </section>
                    <br><br>
                    {% if artifact.versions %}
                        <section class="artifactBody__versions">
                            <h4>Versions</h4>
                            <ul>
                                {% for version in artifact.versions %}
                                    <li>
                                        <div class="row">
                                            <div class="col-lg-3">
                                                Version {{ version.version }}
                                            </div>
                                            <div class="col-lg-6">
                                                <a class="btn btn-success"
                                                   style="font-size: small;padding: 2px"
                                                   href="/api/contents/download/{{ version.urn }}" target="_blank">
                                                    download
                                                </a>
                                                {{ version.created|str_to_datetime }}
                                            </div>
                                        </div>
                                    </li>
                                {% endfor %}
                            </ul>
                        </section>
                    {% endif %}
                    <div class="inline">
                        {{ artifact.created|str_to_datetime }}
                        {% if artifact.tags %}
                            <div class="float-end">
                                {% for tag in artifact.tags %}
                                    <button class="btn btn-secondary mr-2"
                                            style="padding: 2px; font-size: small">{{ tag }}</button>
                                {% endfor %}
                            </div>
                        {% endif %}
                        <br><br>
                    </div>
                    {% if artifact.authors %}
                        <section class="artifactBody__authors">
                            <h4>Authors</h4>
                            <ul>
                                {% for author in artifact.authors %}
                                    <li>
                                        <a href="{% url 'author_detail' uuid=author.uuid %}">
                                            {{ author.name }}
                                        </a>, {{ author.affiliation }}
                                        {% if author.email %}
                                            (<a href="mailto:{{ author.email }}">{{ author.email }}</a>)
                                        {% else %}
                                            (<i style="color: gray">email is private</i>)
                                        {% endif %}
                                    </li>
                                {% endfor %}
                            </ul>
                        </section>
                    {% endif %}
                </td>
            </tr>
            </tbody>
        </table>
    </div>
    {% if debug %}
        <hr>
        <pre><strong>artifact</strong>:<br>{{ artifact|pprint }}</pre>
        <pre><strong>api_user</strong>:<br>{{ api_user|pprint }}</pre>
        <br>
    {% endif %}
{% endblock %}
